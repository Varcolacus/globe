<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Globe 3D - Commerce International France</title>
    <link rel="stylesheet" href="style.css">
    <style>
        #globe-container {
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>
<body>
    <div id="globe-container"></div>
    
    <div class="controls">
        <h1>ï¿½ğŸ‡· Commerce International</h1>
        <div class="control-panel">
            <button id="rotate-toggle" class="btn">â¸ï¸ Pause Rotation</button>
            <button id="reset-view" class="btn">ğŸ”„ RÃ©initialiser Vue</button>
            <button id="show-data" class="btn">ğŸ“Š Afficher DonnÃ©es</button>
        </div>
        
        <div style="margin-top: 15px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 10px;">
            <h3 style="margin: 0 0 10px 0; color: white; font-size: 14px;">ğŸ“… AnnÃ©e:</h3>
            <select id="year-selector" style="width: 100%; padding: 8px; border-radius: 6px; border: none; font-size: 14px; cursor: pointer; margin-bottom: 15px;">
                <option value="2025">2025</option>
                <option value="2024">2024</option>
                <option value="2023">2023</option>
                <option value="2022">2022</option>
                <option value="2021">2021</option>
                <option value="2020">2020</option>
            </select>
            <h3 style="margin: 0 0 10px 0; color: white; font-size: 14px;">ï¿½ Filtrer par:</h3>
            <select id="filter-type-selector" style="width: 100%; padding: 8px; border-radius: 6px; border: none; font-size: 14px; cursor: pointer; margin-bottom: 10px;">
                <option value="all">ğŸŒ Tous les pays</option>
                <option value="region">ğŸŒ RÃ©gion gÃ©ographique</option>
                <option value="income">ğŸ’° Groupe de revenu</option>
                <option value="group">ğŸ¤ Groupe Ã©conomique</option>
                <option value="country">ğŸ³ï¸ Pays individuel</option>
            </select>
            <select id="filter-value-selector" style="width: 100%; padding: 8px; border-radius: 6px; border: none; font-size: 14px; cursor: pointer; margin-bottom: 15px; display: none;">
                <!-- Options remplies dynamiquement -->
            </select>
            <h3 style="margin: 0 0 10px 0; color: white; font-size: 14px;">Visualiser:</h3>
            <div style="display: flex; flex-direction: column; gap: 8px;">
                <label style="color: white; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                    <input type="radio" name="dataType" value="balance" checked style="cursor: pointer;">
                    ğŸ’° Balance (Solde)
                </label>
                <label style="color: white; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                    <input type="radio" name="dataType" value="exports" style="cursor: pointer;">
                    ğŸ“¤ Exports
                </label>
                <label style="color: white; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                    <input type="radio" name="dataType" value="imports" style="cursor: pointer;">
                    ğŸ“¥ Imports
                </label>
                <label style="color: white; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                    <input type="radio" name="dataType" value="volume" style="cursor: pointer;">
                    ğŸ“Š Volume Total
                </label>
            </div>
        </div>
        <div class="info">
            <p>ğŸ–±ï¸ Cliquez et faites glisser pour faire pivoter</p>
            <p>ğŸ” Molette pour zoomer</p>
            <p>ğŸ“ Cliquez sur un pays pour plus d'infos</p>
            <p style="margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,0.2);">
                <strong id="legend-title">Balance des paiements:</strong><br>
                <span id="legend-content">
                    <span style="color: #00ff88;">â—</span> Fort excÃ©dent (>5Mdâ‚¬)<br>
                    <span style="color: #88ff88;">â—</span> ExcÃ©dent<br>
                    <span style="color: #ffaa88;">â—</span> DÃ©ficit lÃ©ger<br>
                    <span style="color: #ff6b6b;">â—</span> Fort dÃ©ficit (>5Mdâ‚¬)
                </span><br>
                <small style="color: #999;">ğŸ“Š DonnÃ©es: API Banque de France</small>
            </p>
        </div>
    </div>

    <!-- Modal pour le tableau de donnÃ©es -->
    <div id="data-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000; overflow: auto;">
        <div style="max-width: 1200px; margin: 50px auto; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 15px; padding: 30px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                <h2 style="color: white; margin: 0;">ğŸ“Š Balance des Paiements - France</h2>
                <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                    <select id="modal-year-selector" style="padding: 10px 15px; border-radius: 8px; border: none; font-size: 14px; cursor: pointer; background: rgba(255,255,255,0.9);">
                        <option value="2025">ğŸ“… 2025</option>
                        <option value="2024">ğŸ“… 2024</option>
                        <option value="2023">ğŸ“… 2023</option>
                        <option value="2022">ğŸ“… 2022</option>
                        <option value="2021">ğŸ“… 2021</option>
                        <option value="2020">ğŸ“… 2020</option>
                    </select>
                    <button id="download-csv" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 16px;">ğŸ’¾ TÃ©lÃ©charger CSV</button>
                    <button id="close-modal" style="background: rgba(255,255,255,0.2); border: none; color: white; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 16px;">âœ• Fermer</button>
                </div>
            </div>
            <div id="metadata-info" style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 12px; margin-bottom: 15px; color: white; font-size: 13px;">
                <!-- MÃ©tadonnÃ©es remplies dynamiquement -->
            </div>
            <div style="background: white; border-radius: 10px; padding: 20px; overflow-x: auto;">
                <table id="data-table" style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: #667eea; color: white;">
                            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">ğŸŒ Pays</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">ğŸ“¤ Exportations (Mâ‚¬)</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">ğŸ“¥ Importations (Mâ‚¬)</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">ğŸ’° Solde (Mâ‚¬)</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">ğŸ“Š Volume Total (Mâ‚¬)</th>
                        </tr>
                    </thead>
                    <tbody id="data-table-body">
                        <!-- Rempli dynamiquement par JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Three.js et Globe.GL locaux -->
    <script src="libs/three.min.js"></script>
    <script src="libs/globe.gl.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>
    <script src="api-config.js"></script>
    <script src="app.js"></script>
</body>
</html>
